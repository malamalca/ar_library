DIM variables[][]nix = 0.00001unID = 1minSegmentLength = AminJunctionLength = A*2minJunctionWidth = 0.01showOffsetLinesNever = 1showOffsetLinesFromScale500 = 2showOffsetLinesFromScale200 = 3showOffsetLinesFromScale100 = 4showOffsetLinesFromScale50 = 5showOffsetLinesFromScale20 = 6showOffsetLinesFromScale10 = 7showOffsetLinesAlways = 8DIM showOffsetLinesScales[8]showOffsetLinesScales[showOffsetLinesNever] = 10000showOffsetLinesScales[showOffsetLinesFromScale500] = 500showOffsetLinesScales[showOffsetLinesFromScale200] = 200showOffsetLinesScales[showOffsetLinesFromScale100] = 100showOffsetLinesScales[showOffsetLinesFromScale50] = 50showOffsetLinesScales[showOffsetLinesFromScale20] = 20showOffsetLinesScales[showOffsetLinesFromScale10] = 10showOffsetLinesScales[showOffsetLinesAlways] = 0!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! inserting segmentIF GLOB_MODPAR_NAME = "insSegments" THEN	insPos = 0	FOR i = 1 TO nSegments		IF (ABS(insSegments[i]-tmpInsSegments[i]) > nix) AND (insSegments[i] > minSegmentLength) THEN			insPos = i			insSegmentLength = insSegments[i]			insDirection = directions[i]		ENDIF	NEXT i	IF insPos > 0 THEN		FOR i = nSegments TO insPos STEP -1			IF (i = insPos) THEN				segments[i+1] = segments[i] - insSegmentLength				IF (i < nSegments) AND (segments[i+1] < minSegmentLength) THEN segments[i+1] = minSegmentLength			ELSE				segments[i+1] = segments[i]			ENDIF			directions[i+1] = directions[i]			junctions[i+1] = junctions[i]			junctionWidths[i+1] = junctionWidths[i]			junctionLengths[i+1] = junctionLengths[i]		NEXT i		segments[insPos] = insSegmentLength		directions[insPos] = insDirection 		directions[insPos+1] = 0		junctions[insPos+1] = 0		junctionWidths[insPos+1] = minJunctionWidth 		junctionLengths[insPos+1] = minJunctionLength		nSegments = nSegments + 1	ENDIFENDIFIF GLOB_MODPAR_NAME = "segments" THEN	totalLength = 0		!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!	! deleting segment	segmentCount = 0	FOR i = 1 TO nSegments		IF (segments[i] < minSegmentLength) AND (ABS(directions[i+1]) < nix) THEN			segments[i] = 0			IF i < nSegments THEN				segments[i+1] = segments[i+1] + tmpSegments[i] - segments[i]				tmpSegments[i+1] = segments[i+1]			ENDIF		ENDIF		IF segments[i] > minSegmentLength THEN			totalLength = totalLength + segments[i]			PUT segments[i], directions[i], junctions[i], junctionWidths[i], junctionLengths[i]			segmentCount = segmentCount + 1			ENDIF	NEXT i	nSegments = segmentCount	FOR i = 1 TO nSegments 		segments[i] = GET(1)		directions[i] = GET(1)		junctions[i] = GET(1)		junctionWidths[i] = GET(1)		junctionLengths[i] = GET(1)	NEXT i	FOR i = nSegments+1 TO 50		segments[i] = 0		directions[i] = 0		junctions[i] = 0		junctionWidths[i] = 0		junctionLengths[i] = 0	NEXT iENDIF