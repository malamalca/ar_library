DIM fontnames[]rrr = request ("FONTNAMES_LIST", "", fontNames)VALUES "textFont" fontNames, customDIM showOffsetLinesList[]showOffsetLinesList[showOffsetLinesNever] = "never"showOffsetLinesList[showOffsetLinesFromScale500] = "from 1:500"showOffsetLinesList[showOffsetLinesFromScale200] = "from 1:200"showOffsetLinesList[showOffsetLinesFromScale100] = "from 1:100"showOffsetLinesList[showOffsetLinesFromScale50] = "from 1:50"showOffsetLinesList[showOffsetLinesFromScale20] = "from 1:20"showOffsetLinesList[showOffsetLinesFromScale10] = "from 1:10"showOffsetLinesList[showOffsetLinesAlways] = "always"VALUES "offsetShow" showOffsetLinesListIF GLOB_MODPAR_NAME = "offsetShow" THEN	FOR i = 1 TO 8		IF showOffsetLinesList[i] = offsetShow THEN			PARAMETERS iOffsetShow = i		ENDIF	NEXT iENDIFIF GLOB_MODPAR_NAME = "junctionHalfWidths" THEN	FOR i = 1 TO nSegments		junctionWidths[i] = junctionHalfWidths[i] * 2	NEXT iENDIF!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! minimum segment lengthIF GLOB_MODPAR_NAME = "segments" THEN	FOR i = 1 TO nSegments		! this is for relative positioning of straight sections		IF (ABS(segments[i]-tmpSegments[i]) > nix) AND (i < nSegments) AND (ABS(directions[i+1]) < nix) THEN			segments[i+1] = segments[i+1] + tmpSegments[i] - segments[i]			tmpSegments[i+1] = segments[i+1]		ENDIF		! this is min segment length		IF (segments[i] < minSegmentLength) AND ((ABS(directions[i+1]) > nix) OR (segments[i] > nix)) THEN			segments[i] = minSegmentLength		ENDIF	NEXT iENDIF!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! lock direction anglesIF ((GLOB_MODPAR_NAME = "directions") AND lockAngles) OR ((GLOB_MODPAR_NAME = "lockAngles") AND lockAngles) THEN	FOR i = 1 TO nSegments		direction = directions[i]		directionAdd = 0		directionSign = 1		IF direction > 180 THEN 			direction = 360 - direction			directionSign = -1			directionAdd = 360		ENDIF				IF direction <= 7.5 THEN			directions[i] = 0		ENDIF		IF direction > 7.5 AND direction <= 22.5 THEN			directions[i] = directionSign * 15 + directionAdd 		ENDIF		IF direction > 22.5 AND direction <= 37.5 THEN			directions[i] = directionSign * 30 + directionAdd 		ENDIF		IF direction > 37.5 AND direction <= 56.5 THEN			directions[i] = directionSign * 45 + directionAdd		ENDIF		IF direction > 56.5 AND direction <= 77.5 THEN			directions[i] = directionSign * 67.5 + directionAdd		ENDIF		IF direction > 77.5 THEN			!directions[i] = directionSign * 87.5 + directionAdd			directions[i] = directionSign * 90 + directionAdd		ENDIF	NEXT i	!PARAMETERS directions = directionsENDIF!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! lock direction anglesIF ((GLOB_MODPAR_NAME = "junctions") AND lockAngles) OR ((GLOB_MODPAR_NAME = "lockAngles") AND lockAngles) THEN	FOR i = 1 TO nSegments		junction = junctions[i]		junctionAdd = 0		junctionSign = 1		IF junction > 180 THEN 			junction = 360 - junction			junctionSign = -1			junctionAdd = 360		ENDIF				IF junction <= 15 THEN			junctions[i] = 0		ENDIF		IF junction > 15 AND junction <= 37.5 THEN			junctions[i] = junctionSign * 30 + junctionAdd 		ENDIF		IF junction > 37.5 AND junction <= 56.5 THEN			junctions[i] = junctionSign * 45 + junctionAdd		ENDIF		IF junction > 56.5 AND junction <= 77.5 THEN			junctions[i] = junctionSign * 67.5 + junctionAdd		ENDIF		IF junction > 77.5 AND junction <= 102.5 THEN			!junctions[i] = junctionSign * 87.5 + junctionAdd			junctions[i] = junctionSign * 90 + junctionAdd		ENDIF		IF junction > 102.5 AND junction <= 124 THEN			junctions[i] = junctionSign * 112.5 + junctionAdd		ENDIF		IF junction > 124 AND junction <= 147.5 THEN			junctions[i] = junctionSign * 135 + junctionAdd		ENDIF		IF junction > 147.5 THEN			junctions[i] = junctionSign * 150 + junctionAdd		ENDIF	NEXT iENDIFPARAMETERS tmpInsSegments = insSegmentsPARAMETERS nSegments = nSegmentsPARAMETERS segments = segmentsPARAMETERS tmpSegments = segmentsPARAMETERS directions = directionsPARAMETERS junctions= junctionsPARAMETERS junctionWidths = junctionWidths PARAMETERS junctionLengths = junctionLengthsPARAMETERS totalLength = totalLengthPARAMETERS totalLength3D = totalLength / COS(0.45*slope)