unId = 1nix = 0.001MAX_CUTS = 10ORIENTATION_VERTICAL = 0ORIENTATION_HORIZONTAL = 1KIND_ONESIDE = 0KIND_LSHAPE = 1PAR_CUT_DIST = 1PAR_CUT_HEIGHT = 2PAR_CUT_THICKNESS1 = 3PAR_CUT_THICKNESS2 = 4ADD_CUT_DIST = -0.1DEF_CUT_HEIGHT = BDEF_CUT_THICKNESS = A/2: if (A/2 > B) then DEF_CUT_THICKNESS = B/2DEF_ROTATION = 0if GLOB_MODPAR_NAME = "add_cut_distance" then	insi = 0	while (cut_lengths[insi+1][PAR_CUT_DIST] < add_cut_distance) and (insi < n+1) do		insi = insi + 1	endwhile	if add_cut_distance > 0 then		insi = insi + 1		if insi > n+1 then insi = n+1 ! this is a hack for routine below that is removing duplicate nodes		for i = n to insi step -1			cut_lengths[i+1] = cut_lengths[i]			cut_kinds[i+1] = cut_kinds[i]			cut_rotations[i+1] = cut_rotations[i]		next i		cut_lengths[insi][PAR_CUT_DIST] = add_cut_distance		cut_lengths[insi][PAR_CUT_HEIGHT] = DEF_CUT_HEIGHT		cut_lengths[insi][PAR_CUT_THICKNESS1] = DEF_CUT_THICKNESS		cut_rotations[insi] = DEF_ROTATION		cut_kinds[insi] = KIND_ONESIDE		n = n + 1	endifendif! cleanuplengthTest = hor_length: if orientation = ORIENTATION_VERTICAL then lengthTest = ZZYZXn0 = 0for i = 1 to n	distToNext = 1	if i < n then		distToNext = abs(cut_lengths[i][PAR_CUT_DIST] - cut_lengths[i+1][PAR_CUT_DIST])	endif	if (cut_lengths[i][PAR_CUT_DIST] < lengthTest) and (cut_lengths[i][PAR_CUT_DIST] > 0) and (distToNext > nix) then		n0 = n0 + 1		put cut_lengths[i][PAR_CUT_DIST]		put cut_lengths[i][PAR_CUT_HEIGHT]		put cut_lengths[i][PAR_CUT_THICKNESS1]		put cut_lengths[i][PAR_CUT_THICKNESS2]		put cut_kinds[i]		put cut_rotations[i]	endifnext in = n0! fill up points with new valuesfor i = 1 to n	cut_lengths[i][PAR_CUT_DIST] = get(1)	cut_lengths[i][PAR_CUT_HEIGHT] = get(1)	cut_lengths[i][PAR_CUT_THICKNESS1] = get(1)	cut_lengths[i][PAR_CUT_THICKNESS2] = get(1)	cut_kinds[i] = get(1)	cut_rotations[i] = get(1)next ifor i = n + 1 to MAX_CUTS	cut_lengths[i][PAR_CUT_DIST] = ADD_CUT_DIST	cut_lengths[i][PAR_CUT_HEIGHT] = 0	cut_lengths[i][PAR_CUT_THICKNESS1] = 0	cut_lengths[i][PAR_CUT_THICKNESS2] = 0	cut_kinds[i] = 0	cut_rotations[i] = 0next i