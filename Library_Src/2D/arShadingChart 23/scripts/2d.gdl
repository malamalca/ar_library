unId = 1hotspot2 0, 0: unId = unId + 1dim points[20][4]for i = 1 to n	line2 originOffsetX, originOffsetY, x[i], y[i]	hotspot2 originOffsetX, y[i], unId, x[i], 1+128: unId = unId + 1	hotspot2 x[i], y[i], unId, x[i], 2: unId = unId + 1	hotspot2 -1, y[i], unId, x[i], 3: unId = unId + 1	hotspot2 x[i], originOffsetX, unId, y[i], 1+128: unId = unId + 1	hotspot2 x[i], y[i], unId, y[i], 2: unId = unId + 1	hotspot2 x[i], -1, unId, y[i], 3: unId = unId + 1	dX = x[i] - originOffsetX	dY = y[i] - originOffsetY	iLen = sqr(dX^2 + dY^2)	text2 x[i], y[i], str(atn(z[i]/iLen), 5, 2)	iAngle = acs(dX/iLen)	if dY < nix then		iAngle = 360 - iAngle 	endif	!!! convert to solar azimuth	iAngle = 360 - iAngle + 90	if iAngle > 360 then		iAngle = iAngle - 360	endif	text2 x[i], y[i]+0.4, str(iAngle , 5, 2)	points[i][1] = x[i]	points[i][2] = y[i]	points[i][3] = atn(z[i]/iLen) 		! inclination	points[i][4] = iAngle				! azimuth	next ipen penOutlineif n > 1 then	!!! bubble sort	for i = 1 to n-1		for j = 1 to n-i			if points[j+1][4] > points[j][4] then				tmpX = points[j][1]				tmpY = points[j][2]				tmpL = points[j][3]				tmpA = points[j][4]				points[j][1] = points[j+1][1]				points[j][2] = points[j+1][2]				points[j][3] = points[j+1][3]				points[j][4] = points[j+1][4]				points[j+1][1] = tmpX				points[j+1][2] = tmpY				points[j+1][3] = tmpL				points[j+1][4] = tmpA			endif		next j	next i	!!! show shadow line on situation	for i = 1 to n-1		line2 points[i][1], points[i][2], points[i+1][1], points[i+1][2]	next i	!!! fill points for chart parameters	xScale = gridSpacing * 0.2   !0.03	yScale = gridSpacing * 0.6   !0.09	for i = 1 to n		shadeX[i] = points[i][4] * xScale		shadeY[i] = points[i][3] * yScale	next i	!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!	!!! display chart	add2 chartOffsetX, chartOffsetY	call "arSunChart 24" parameters dTgmt=dTgmt, latitude=latitude, longitude=longitude, 		n = n, shadeX = shadeX, shadeY = shadeY, 		fillShade = fillShade, penOutline = penOutline, penShadeFill = penShadeFill, penShadeBg = penShadeBg,		penGrid = penGrid, penSunpath = penSunpath, penSunpath2 = penSunpath2, penHours = penHours, 		axisFont = axisFont, fontsizeGrid = fontsizeGrid, legendFont = legendFont, legendFontSize = legendFontSize,		gridSpacing = gridSpacing	del 1endif!!! insert new ray hotspotif n <= MAX_POINTS then	add2 originOffsetX, originOffsetY	hotspot2 0, insy, unId, insx, 1+128: unId = unId + 1	hotspot2 insx, insy, unId, insx, 2: unId = unId + 1	hotspot2 -1, insy, unId, insx, 3: unId = unId + 1		hotspot2 insx, 0, unId, insy, 1+128: unId = unId + 1	hotspot2 insx, insy, unId, insy, 2: unId = unId + 1	hotspot2 insx, -1, unId, insy, 3: unId = unId + 1	del	1endif!!! grid spacinghotspot2 chartOffsetX, chartOffsetY, unId, gridSpacing, 1+128: unId = unId + 1hotspot2 chartOffsetX, chartOffsetY+gridSpacing, unId, gridSpacing, 2: unId = unId + 1hotspot2 chartOffsetX, chartOffsetY-1, unId, gridSpacing, 3: unId = unId + 1!!! chart offset hotspothotspot2 0, chartOffsetY, unId, chartOffsetX, 1+128: unId = unId + 1hotspot2 chartOffsetX, chartOffsetY, unId, chartOffsetX, 2: unId = unId + 1hotspot2 -1, chartOffsetY, unId, chartOffsetX, 3: unId = unId + 1hotspot2 chartOffsetX, 0, unId, chartOffsetY, 1+128: unId = unId + 1hotspot2 chartOffsetX, chartOffsetY, unId, chartOffsetY, 2: unId = unId + 1hotspot2 chartOffsetX, -1, unId, chartOffsetY, 3: unId = unId + 1!!! origin offset hotspothotspot2 0, originOffsetY, unId, originOffsetX, 1+128: unId = unId + 1hotspot2 originOffsetX, originOffsetY, unId, originOffsetX, 2: unId = unId + 1hotspot2 -1, originOffsetY, unId, originOffsetX, 3: unId = unId + 1hotspot2 originOffsetX, 0, unId, originOffsetY, 1+128: unId = unId + 1hotspot2 originOffsetX, originOffsetY, unId, originOffsetY, 2: unId = unId + 1hotspot2 originOffsetX, -1, unId, originOffsetY, 3: unId = unId + 1